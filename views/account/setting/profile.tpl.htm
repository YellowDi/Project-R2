<?php TPL::output('global/header-less.tpl.htm'); ?>
<div class="screenContent">
	<div class="settings container u-maxWidth740">
		<div class="hero hero--standalone hero--alignLeft"><h1 class="hero-title">设置</h1></div>

		<form id="setting_form" method="post" action="account/ajax/profile_setting/">
			<!-- 邮箱设置 -->
			<div class="heading u-clearfix heading--borderedBottom"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title">账号</span></div></div></div>
			<div class="list u-marginBottom50">
				<!-- 电子邮箱 -->
				<section class="list-item list-item--padded">
					<div class="list-itemInfo">
						<h2 class="list-itemTitle">电子邮箱</h2>
						<input class="list-itemInput list-itemInput--wide js-emailSettingsInput" type="email" value="<?php echo $this->user_info['email']; ?>" disabled="">
					</div>
					<?php if ($this->user_info['valid_email'] == 0) { ?>
						<div class="list-itemActions">
							<a class="button" onclick="AWS.ajax_request(G_BASE_URL + '/account/ajax/send_valid_mail/');">重发验证邮件</a>
						</div>
					<?php } ?>
				</section>
				<!-- end 电子邮箱 -->
			</div>
			<!-- end 邮箱设置 -->

			<!-- 个人资料 -->
			<div class="heading u-clearfix heading--borderedBottom"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title">个人资料</span></div></div></div>
			<div class="list u-marginBottom50">
				<!-- 昵称 -->
				<section class="list-item list-item--padded">
					<div class="list-itemInfo">
						<h2 class="list-itemTitle">昵称</h2>
						<span class="list-itemInputPrefix u-noUserSelect">http://r2vg.com/people/</span><input class="list-itemInput list-itemInput--username" maxlength="15" disabled="" value="<?php echo $this->user_info['user_name']; ?>"><span class="list-itemStatus js-usernameSettingsItem"></span>
					</div>
				</section>
				<!-- end 昵称 -->
				<!-- 介绍 -->
				<section class="list-item list-item--padded">
					<div class="list-itemInfo">
						<h2 class="list-itemTitle">介绍</h2>
						<input class="list-itemInput" name="signature" maxlength="128" type="text" value="<?php echo $this->user_info['signature']; ?>"<?php if ($this->user_info['verified']) { ?> disabled="disabled"<?php } ?> />
					</div>
				</section>
				<!-- end 介绍 -->
				<!-- 头像 -->
				<section class="list-item list-item--padded">
					<div class="list-itemInfo">
						<h2 class="list-itemTitle">头像</h2>
						<p class="list-itemDescription">R2VG 禁止使用任何低俗或者敏感图片作为头像，<strong>如果你是男的，请不要用女人的照片作为头像，这样可能会对其他会员产生误导。</strong></p>
					</div>
					<div class="list-itemActions">
						<img class="list-itemImage" src="<?php echo get_avatar_url($this->user_id, 'max'); ?>?rand=<?php echo rand(1, 999); ?>" alt="" id="avatar_src" />
						<span class="list-itemActionGroup">
							<a class="list-itemName" id="avatar_uploader" href="javascript:;">上传头像</a> <span id="avatar_uploading_status" class="collapse"><i class="aw-loading"></i> 文件上传中</span>
							<span class="button button--chromeless u-baseColor--buttonNormal button--disconnect button--dangerHover">支持 jpg、gif、png 等格式的图片</span>
						</span>
					</div>
				</section>
				<!-- end 头像 -->
			</div>
			<!-- end 个人资料 -->

			<!-- 隐私 -->
			<div class="heading u-clearfix heading--borderedBottom"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title">隐私</span></div></div></div>
			<div class="list u-marginBottom50">
				<!-- 私信设置 -->
				<section class="list-item list-item--padded">
					<div class="list-itemInfo">
						<h2 class="list-itemTitle">私信设置</h2>
						<p class="list-itemDescription">谁可以给我发私信</p>
					</div>
					<div class="list-itemActions buttonSwitch">
						<label><input type="radio"value="0" name="inbox_recv"<?php if (!$this->user_info['inbox_recv']) { ?> checked="checked"<?php } ?> /> <?php _e('所有人'); ?></label>
						<label><input type="radio"value="1" name="inbox_recv"<?php if ($this->user_info['inbox_recv'] == 1) { ?> checked="checked"<?php } ?> /> <?php _e('我关注的人'); ?></label>
					</div>
				</section>
				<!-- end 私信设置 -->
			</div>
			<!-- end 隐私 -->
		</form>

		<a href="javascript:;" class="button button--primary" onclick="AWS.ajax_post($('#setting_form'));"><?php _e('保存'); ?></a>
		<div class="u-paddingBottom30"></div>

	</div>
</div>

<script type="text/javascript">
$(document).ready(function () {
	$('.select_area').LocationSelect({
        labels: ["<?php _e('请选择省份或直辖市'); ?>", "<?php _e('请选择城市'); ?>"],
        elements: document.getElementsByTagName("select"),
        detector: function () {
            this.select(["<?php echo $this->user_info['province']; ?>", "<?php echo $this->user_info['city']; ?>"]);
        },
		dataUrl: G_BASE_URL.replace('/?', '') + '/static/js/areas.js'
    });

    var fileUpload = new FileUpload('avatar', $('#avatar_uploader'), $('#avatar_src'), G_BASE_URL + '/account/ajax/avatar_upload/', {'loading_status' : '#avatar_uploading_status'});
});

<?php if ($this->education_experience_list) { ?>
var education_experience_list = <?php echo json_encode($this->education_experience_list); ?>
<?php } ?>

<?php if ($this->work_experience_list) { ?>
var work_experience_list = <?php echo json_encode($this->work_experience_list); ?>
<?php } ?>
</script>

<script type="text/javascript" src="<?php echo G_STATIC_URL; ?>/js/app/setting.js"></script>
